<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculating PK parameters of simulation outputs • ospsuite</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculating PK parameters of simulation outputs">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ospsuite</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">12.3.2.9005</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ospsuite.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Primary functions</h6></li>
    <li><a class="dropdown-item" href="../articles/load-get.html">Loading a simulation and accessing entities</a></li>
    <li><a class="dropdown-item" href="../articles/set-values.html">Changing parameter and molecule start values</a></li>
    <li><a class="dropdown-item" href="../articles/run-simulation.html">Running a simulation</a></li>
    <li><a class="dropdown-item" href="../articles/pk-analysis.html">Calculating PK parameters of simulation outputs</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity analysis</a></li>
    <li><a class="dropdown-item" href="../articles/create-individual.html">Creating individuals</a></li>
    <li><a class="dropdown-item" href="../articles/create-run-population.html">Population simulations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Figure creation</h6></li>
    <li><a class="dropdown-item" href="../articles/observed-data.html">Observed data</a></li>
    <li><a class="dropdown-item" href="../articles/data-combined.html">Working with `DataCombined` class</a></li>
    <li><a class="dropdown-item" href="../articles/data-combined-plotting.html">Visualizations with `DataCombined`</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/efficient-calculations.html">Efficient calculation</a></li>
    <li><a class="dropdown-item" href="../articles/table-parameters.html">Table parameters</a></li>
    <li><a class="dropdown-item" href="../articles/unit-conversion.html">Dimensions and Units</a></li>
    <li><a class="dropdown-item" href="../articles/PKSim-installation.html">PK-Sim Installation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/open-systems-pharmacology/ospsuite-r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculating PK parameters of simulation outputs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/open-systems-pharmacology/ospsuite-r/blob/main/vignettes/pk-analysis.Rmd" class="external-link"><code>vignettes/pk-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>pk-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="calculating-pk-parameters">Calculating PK parameters<a class="anchor" aria-label="anchor" href="#calculating-pk-parameters"></a>
</h2>
<p>The <a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a> package gives you access to the standard
PK Parameters calculated by PK-Sim such as AUC, Cmax etc. For the
complete list of PK Parameters supported out of the box, please refer to
the <a href="https://docs.open-systems-pharmacology.org/working-with-pk-sim/pk-sim-documentation/pk-sim-simulations#pk-parameters" class="external-link">online
documentation</a>.</p>
<p>PK parameters can be calculated for all outputs of a simulation.
First, simulation results must be calculated, and the
<code>SimulationResults</code> object is then passed to the method
<code>calculatePKAnalyses</code>. For the list of calculated PK
parameters and their description, please refer to <a href="https://docs.open-systems-pharmacology.org/working-with-pk-sim/pk-sim-documentation/pk-sim-simulations#pk-analysis-view" class="external-link">OSPS
documentation</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the simulation</span></span>
<span><span class="va">simFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Aciclovir.pkml"</span>, package <span class="op">=</span> <span class="st">"ospsuite"</span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadSimulation.html">loadSimulation</a></span><span class="op">(</span><span class="va">simFilePath</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the simulation</span></span>
<span><span class="va">simulationResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulations.html">runSimulations</a></span><span class="op">(</span>simulations <span class="op">=</span> <span class="va">sim</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Calculate PK-analyses</span></span>
<span><span class="va">pkAnalysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculatePKAnalyses.html">calculatePKAnalyses</a></span><span class="op">(</span>results <span class="op">=</span> <span class="va">simulationResults</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the path of the simulated output</span></span>
<span><span class="va">outputPath</span> <span class="op">&lt;-</span> <span class="va">simulationResults</span><span class="op">$</span><span class="va">allQuantityPaths</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">outputPath</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral Venous Blood)"</span></span>
<span></span>
<span><span class="co"># Get all calculated PK parameters for the output path</span></span>
<span><span class="va">allPkParams</span> <span class="op">&lt;-</span> <span class="va">pkAnalysis</span><span class="op">$</span><span class="fu">allPKParametersFor</span><span class="op">(</span><span class="va">outputPath</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">allPkParams</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: C_max</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Concentration (molar)</span></span>
<span><span class="co">#&gt;   • Unit: µmol/l</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: C_max_norm</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Concentration (mass)</span></span>
<span><span class="co">#&gt;   • Unit: kg/l</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: t_max</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Time</span></span>
<span><span class="co">#&gt;   • Unit: min</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: C_tEnd</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Concentration (molar)</span></span>
<span><span class="co">#&gt;   • Unit: µmol/l</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: AUC_tEnd</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: AUC (molar)</span></span>
<span><span class="co">#&gt;   • Unit: µmol*min/l</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: AUC_tEnd_norm</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: AUC (mass)</span></span>
<span><span class="co">#&gt;   • Unit: kg*min/l</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: AUC_inf</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: AUC (molar)</span></span>
<span><span class="co">#&gt;   • Unit: µmol*min/l</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: AUC_inf_norm</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: AUC (mass)</span></span>
<span><span class="co">#&gt;   • Unit: kg*min/l</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: MRT</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Time</span></span>
<span><span class="co">#&gt;   • Unit: min</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: Thalf</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Time</span></span>
<span><span class="co">#&gt;   • Unit: min</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[11]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: FractionAucLastToInf</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Fraction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[12]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: CL</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Flow per weight</span></span>
<span><span class="co">#&gt;   • Unit: l/min/kg</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[13]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: Vss</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Volume per body weight</span></span>
<span><span class="co">#&gt;   • Unit: l/kg</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[14]]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: Vd</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Volume per body weight</span></span>
<span><span class="co">#&gt;   • Unit: l/kg</span></span>
<span></span>
<span><span class="co"># Get C_max parameter</span></span>
<span><span class="va">c_max</span> <span class="op">&lt;-</span> <span class="va">pkAnalysis</span><span class="op">$</span><span class="fu">pKParameterFor</span><span class="op">(</span>quantityPath <span class="op">=</span> <span class="va">outputPath</span>, pkParameter <span class="op">=</span> <span class="st">"C_max"</span><span class="op">)</span></span>
<span><span class="va">c_max</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: C_max</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Concentration (molar)</span></span>
<span><span class="co">#&gt;   • Unit: µmol/l</span></span></code></pre></div>
<p>The function <code>calculatePKAnalyses</code> returns an object of
the class <code>SimulationPKAnalyses</code>, which allows to retrieve
either a certain PK parameter for an output path, or all calculated PK
parameters for an output path.</p>
<p>The methods <code>$allPKParametersFor()</code> and
<code>$pKParameterFor()</code> return a object (or a list of objects) of
the class <code>QuantityPKParameter</code>, with the fields
<code>$name</code> which is the name of the pk-parameter (e.g. “C_max”),
<code>$quantityPath</code> the path of the output the parameter has been
calculated for, and <code>$values</code> the value (or list of values
for a population simulation).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get C_max parameter</span></span>
<span><span class="va">c_max</span> <span class="op">&lt;-</span> <span class="va">pkAnalysis</span><span class="op">$</span><span class="fu">pKParameterFor</span><span class="op">(</span>quantityPath <span class="op">=</span> <span class="va">outputPath</span>, pkParameter <span class="op">=</span> <span class="st">"C_max"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">c_max</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;QuantityPKParameter&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: C_max</span></span>
<span><span class="co">#&gt;   • QuantityPath: Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral</span></span>
<span><span class="co">#&gt;   Venous Blood)</span></span>
<span><span class="co">#&gt;   • Dimension: Concentration (molar)</span></span>
<span><span class="co">#&gt;   • Unit: µmol/l</span></span>
<span></span>
<span><span class="va">c_max</span><span class="op">$</span><span class="va">name</span></span>
<span><span class="co">#&gt; [1] "C_max"</span></span>
<span><span class="va">c_max</span><span class="op">$</span><span class="va">quantityPath</span></span>
<span><span class="co">#&gt; [1] "Organism|PeripheralVenousBlood|Aciclovir|Plasma (Peripheral Venous Blood)"</span></span>
<span><span class="va">c_max</span><span class="op">$</span><span class="va">values</span></span>
<span><span class="co">#&gt; [1] 50.25272</span></span></code></pre></div>
<p>In case of a population simulation, <code>$values</code> return a
list of values calculated for each individual.</p>
</div>
<div class="section level2">
<h2 id="extracting-a-dataframe">Extracting a dataframe<a class="anchor" aria-label="anchor" href="#extracting-a-dataframe"></a>
</h2>
<p>Sometimes it is desirable to have the calculated parameters in a
dataframe for working with them further in other workflows (e.g. data
wrangling), and the package provides a convenient helper to extract
it:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pkAnalysesToDataFrame.html">pkAnalysesToDataFrame</a></span><span class="op">(</span><span class="va">pkAnalysis</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 5</span></span></span>
<span><span class="co">#&gt;    IndividualId QuantityPath                            Parameter    Value Unit </span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>            0 Organism|PeripheralVenousBlood|Aciclov… C_max     5.03<span style="color: #949494;">e</span>+ 1 µmol…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>            0 Organism|PeripheralVenousBlood|Aciclov… C_max_no… 3.07<span style="color: #949494;">e</span>+ 6 mg/l </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>            0 Organism|PeripheralVenousBlood|Aciclov… t_max     1.83<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span> h    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>            0 Organism|PeripheralVenousBlood|Aciclov… C_tEnd    3.25<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span> µmol…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>            0 Organism|PeripheralVenousBlood|Aciclov… AUC_tEnd  4.06<span style="color: #949494;">e</span>+ 3 µmol…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>            0 Organism|PeripheralVenousBlood|Aciclov… AUC_tEnd… 2.48<span style="color: #949494;">e</span>+11 µg*m…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>            0 Organism|PeripheralVenousBlood|Aciclov… AUC_inf   4.07<span style="color: #949494;">e</span>+ 3 µmol…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>            0 Organism|PeripheralVenousBlood|Aciclov… AUC_inf_… 2.48<span style="color: #949494;">e</span>+11 µg*m…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>            0 Organism|PeripheralVenousBlood|Aciclov… MRT       3.22<span style="color: #949494;">e</span>+ 0 h    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>            0 Organism|PeripheralVenousBlood|Aciclov… Thalf     3.02<span style="color: #949494;">e</span>+ 0 h    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>            0 Organism|PeripheralVenousBlood|Aciclov… Fraction… 2.09<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span> <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>            0 Organism|PeripheralVenousBlood|Aciclov… CL        4.02<span style="color: #949494;">e</span>+ 0 ml/m…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>            0 Organism|PeripheralVenousBlood|Aciclov… Vss       7.78<span style="color: #949494;">e</span>+ 2 ml/kg</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>            0 Organism|PeripheralVenousBlood|Aciclov… Vd        1.05<span style="color: #949494;">e</span>+ 3 ml/kg</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-and-export-of-pk-analyses">Import and export of PK-analyses<a class="anchor" aria-label="anchor" href="#import-and-export-of-pk-analyses"></a>
</h2>
<p>Population analysis calculated in R can be exported to a *.csv file
and loaded in PK-Sim, and vice versa.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load and run the simulation</span></span>
<span><span class="va">simFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Aciclovir.pkml"</span>, package <span class="op">=</span> <span class="st">"ospsuite"</span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadSimulation.html">loadSimulation</a></span><span class="op">(</span><span class="va">simFilePath</span><span class="op">)</span></span>
<span><span class="va">simulationResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulations.html">runSimulations</a></span><span class="op">(</span>simulations <span class="op">=</span> <span class="va">sim</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Calculate PK-analysis</span></span>
<span><span class="va">pkAnalysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculatePKAnalyses.html">calculatePKAnalyses</a></span><span class="op">(</span>results <span class="op">=</span> <span class="va">simulationResults</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export to csv</span></span>
<span><span class="va">csvPKAnalysisPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"PKAnalyses.csv"</span>, package <span class="op">=</span> <span class="st">"ospsuite"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/exportPKAnalysesToCSV.html">exportPKAnalysesToCSV</a></span><span class="op">(</span>pkAnalyses <span class="op">=</span> <span class="va">pkAnalysis</span>, filePath <span class="op">=</span> <span class="va">csvPKAnalysisPath</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load from csv</span></span>
<span><span class="va">pkAnalysisLoaded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importPKAnalysesFromCSV.html">importPKAnalysesFromCSV</a></span><span class="op">(</span>filePath <span class="op">=</span> <span class="va">csvPKAnalysisPath</span>, simulation <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="user-defined-pk-parameters">User-Defined PK Parameters<a class="anchor" aria-label="anchor" href="#user-defined-pk-parameters"></a>
</h2>
<p>The <a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a> package also supports user-defined PK
Parameters, e.g. PK Parameter that can be tailored to specific project
needs. This feature is useful when calculating PK Parameters for
specific time intervals, or to apply PK Parameters for output not using
the dimension <code>Concentration</code>.</p>
<p>A User-Defined PK Parameter is always based on an existing
PK-Parameter and simply extends the way the output is calculated. It is
not possible at the moment to define your own <code>formula</code>.</p>
<p>The utility <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/addUserDefinedPKParameter.html"><code>addUserDefinedPKParameter</code></a>
creates and returns an instance of the <a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/UserDefinedPKParameter.html"><code>UserDefinedPKParameter</code></a>
which can then be parameterized for specific requirements.</p>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<div class="section level4">
<h4 id="calculate-auc-between-for-a-specific-time-interval-">Calculate AUC between for a specific time interval.<a class="anchor" aria-label="anchor" href="#calculate-auc-between-for-a-specific-time-interval-"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adds a user defined parameter named `MyAuc` that will calculate the value of AUC between t=50 min and t=80min only.</span></span>
<span></span>
<span><span class="co"># Create a new parameter based on the standard AUC parameter</span></span>
<span><span class="va">myAUC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addUserDefinedPKParameter.html">addUserDefinedPKParameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"MyAUC"</span>,</span>
<span>  standardPKParameter <span class="op">=</span> <span class="va">StandardPKParameter</span><span class="op">$</span><span class="va">AUC_tEnd</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specifies start time and end time in minute</span></span>
<span><span class="va">myAUC</span><span class="op">$</span><span class="va">startTime</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">myAUC</span><span class="op">$</span><span class="va">endTime</span> <span class="op">&lt;-</span> <span class="fl">80</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="calculate-cmax-between-the-4th-and-5th-application-of-a-multiple-applications-simulation-">Calculate CMax between the 4th and 5th application of a multiple
applications simulation.<a class="anchor" aria-label="anchor" href="#calculate-cmax-between-the-4th-and-5th-application-of-a-multiple-applications-simulation-"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adds a user defined parameter named `MyCMax` that will calculate the value of Cmax between the 4th and 5th application</span></span>
<span></span>
<span><span class="co"># Create a new parameter based on the standard C_max parameter</span></span>
<span><span class="va">myCMax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addUserDefinedPKParameter.html">addUserDefinedPKParameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"MyCMax"</span>,</span>
<span>  standardPKParameter <span class="op">=</span> <span class="va">StandardPKParameter</span><span class="op">$</span><span class="va">C_max</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specifies start application (4th) and end application (5th)</span></span>
<span><span class="va">myCMax</span><span class="op">$</span><span class="va">startApplicationIndex</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">myCMax</span><span class="op">$</span><span class="va">endApplicationIndex</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="calculate-cmax-between-the-4th-and-5th-application-of-a-multiple-applications-simulation-and-apply-a-time-offset">Calculate CMax between the 4th and 5th application of a multiple
applications simulation and apply a time offset<a class="anchor" aria-label="anchor" href="#calculate-cmax-between-the-4th-and-5th-application-of-a-multiple-applications-simulation-and-apply-a-time-offset"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adds a user defined parameter named `MyCMax` that will calculate the value of Cmax between the 4th application start time + 10 min and</span></span>
<span><span class="co"># the 5th application start time + 20min</span></span>
<span></span>
<span><span class="co"># Create a new parameter based on the standard C_max parameter</span></span>
<span><span class="va">myCMax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addUserDefinedPKParameter.html">addUserDefinedPKParameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"MyCMax"</span>,</span>
<span>  standardPKParameter <span class="op">=</span> <span class="va">StandardPKParameter</span><span class="op">$</span><span class="va">C_max</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specifies start application (4th) and end application (5th)</span></span>
<span><span class="va">myCMax</span><span class="op">$</span><span class="va">startApplicationIndex</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">myCMax</span><span class="op">$</span><span class="va">endApplicationIndex</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Specifies start time offset. The PK calculations will effectively start at StartTime of 4th Application + 10 min</span></span>
<span><span class="va">myCMax</span><span class="op">$</span><span class="va">startTimeOffset</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Specifies end time offset. The PK calculations will effectively ends at StartTime of 5th Application + 20 min</span></span>
<span><span class="va">myCMax</span><span class="op">$</span><span class="va">endTimeOffset</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="update-dimension-of-a-standard-parameter-for-correct-visualization">Update Dimension of a standard parameter for correct
visualization<a class="anchor" aria-label="anchor" href="#update-dimension-of-a-standard-parameter-for-correct-visualization"></a>
</h4>
<p>PK parameters currently always assume that the underlying quantity is
a concentration and do not check for units. If the quantity of interest
has another dimension, creating a user-defined PK parameter
<code>AND</code> setting its display unit to any valid unit of the
target dimension can do the trick</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's assume there is an observer called Q_observer in mg/m2 using the dimension Dose per body surface area.</span></span>
<span><span class="co"># Simply using C_max would result in the parameter being shown in umol\l.</span></span>
<span><span class="co"># To see the correct unit and dimension, the following can be done:</span></span>
<span></span>
<span><span class="va">QMax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addUserDefinedPKParameter.html">addUserDefinedPKParameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Q_max"</span>,</span>
<span>  standardPKParameter <span class="op">=</span> <span class="va">StandardPKParameter</span><span class="op">$</span><span class="va">C_max</span>,</span>
<span>  displayName <span class="op">=</span> <span class="st">"Q max"</span>,</span>
<span>  displayUnit <span class="op">=</span> <span class="st">"mg/m²"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>What will happen here:</p>
<ul>
<li>The dimension of the user defined PK Parameter will be estimated
from the display unit, e.g in this case <code>mg/m²</code>
</li>
<li>The calculated value of the user defined PK Parameter will be
interpreted as value in the base unit of this dimension, e.g. here
“kg/dm²”</li>
<li>If the display unit differs from the base unit of the dimension,
calculated value will be converted into the target display unit</li>
</ul>
<p>E.g. in the example above:</p>
<ul>
<li>First, the C_max value of the quantity will be calculated (because
the user defined parameter is derived from C_max)</li>
<li>From the display unit <code>mg/m²</code>, the dimension will be
estimated (“Dose per body surface area”)</li>
<li>The calculated C_max value will be interpreted as a value in
<code>kg/dm²</code>
</li>
<li>Finally, the calculated value will be converted to
<code>mg/m²</code> and set in the user defined PK Parameter.</li>
</ul>
<p>To see all other options for user defined PK Parameter, refer to the
documentation of <code>UserDefinedPKParameter</code>
(?UserDefinedPKParameter in RStudio)</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.open-systems-pharmacology.org/" class="external-link"><img src="https://avatars.githubusercontent.com/u/25098323?s=33" alt="Open System Pharmacology Logo">Open Systems Pharmacology</a>, <a href="https://github.com/msevestre" class="external-link">Michael Sevestre</a>, <a href="https://github.com/PavelBal" class="external-link">Pavel Balazki</a>, <a href="https://github.com/Yuri05" class="external-link">Juri Solodenko</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Felix MIL.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
