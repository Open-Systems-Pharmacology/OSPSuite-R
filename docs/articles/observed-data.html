<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ospsuite">
<title>Observed data • ospsuite</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Observed data">
<meta property="og:description" content="ospsuite">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ospsuite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">11.1.188</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ospsuite.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Primary functions</h6>
    <a class="dropdown-item" href="../articles/load-get.html">Loading a simulation and accessing entities</a>
    <a class="dropdown-item" href="../articles/set-values.html">Changing parameter and molecule start values</a>
    <a class="dropdown-item" href="../articles/run-simulation.html">Running a simulation</a>
    <a class="dropdown-item" href="../articles/pk-analysis.html">Calculating PK parameters of simulation outputs</a>
    <a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity analysis</a>
    <a class="dropdown-item" href="../articles/create-individual.html">Creating individuals</a>
    <a class="dropdown-item" href="../articles/create-run-population.html">Population simulations</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Figure creation</h6>
    <a class="dropdown-item" href="../articles/observed-data.html">Observed data</a>
    <a class="dropdown-item" href="../articles/data-combined.html">Working with `DataCombined` class</a>
    <a class="dropdown-item" href="../articles/data-combined-plotting.html">Visualizations with `DataCombined`</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6>
    <a class="dropdown-item" href="../articles/efficient-calculations.html">Efficient calculation</a>
    <a class="dropdown-item" href="../articles/table-parameters.html">Table parameters</a>
    <a class="dropdown-item" href="../articles/unit-conversion.html">Dimensions and Units</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/open-systems-pharmacology/ospsuite-r/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="observed-data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Observed data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/open-systems-pharmacology/ospsuite-r/blob/HEAD/vignettes/observed-data.Rmd" class="external-link"><code>vignettes/observed-data.Rmd</code></a></small>
      <div class="d-none name"><code>observed-data.Rmd</code></div>
    </div>

    
    
<p><a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a> offers a concept of storing and processing numerical x-y data in a unified format by implementing a <code>DataSet</code> class. <code>DataSet</code> objects standardize handling of (observed) data coming from different sources, such as excel files using the data importer functionality of the OSPS, loaded from <code>*.pkml</code>, or manually created. This vignette gives an overview of the options to create <code>DataSet</code> objects and combine them into grouped data sets using the <a href="data-combined.html"><code>DataCombined</code></a> class.</p>
<div class="section level2">
<h2 id="dataset">DataSet<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h2>
<p>A <code>DataSet</code> object stores numerical data pairs - typically time as x values and measurement as y values - and optionally the measurement error . All values have a <em>dimension</em> and a <em>unit</em> (see <a href="unit-conversion.html">Dimensions and Units</a> for more information). Furthermore, each <code>DataSet</code> must have a <em>name</em>. When creating a <code>DataSet</code> from scratch (e.g. when the user wants to manually input observed data), a name must be provided:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: rClr</span></span>
<span><span class="co">#&gt; Loading the dynamic library for Microsoft .NET runtime...</span></span>
<span><span class="co">#&gt; Loaded Common Language Runtime version 4.0.30319.42000</span></span>
<span></span>
<span><span class="co"># Create an empty data set</span></span>
<span><span class="va">dataSet</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataSet.html">DataSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"My data set"</span><span class="op">)</span></span></code></pre></div>
<p>After creation, the <code>DataSet</code> does not hold any data. The default dimension and unit for the x values is <code>Time</code> and <code>h</code>, respectively. The default dimension and unit for the y values is <code>Concentration (mass)</code> and <code>mg/l</code>, respectively. The dimension of the error values always corresponds to the dimension of the y values, though the units may differ.</p>
<p>Setting numerical values (or overwriting current values) is performed by the <code>$setValues()</code> method:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataSet</span><span class="op">$</span><span class="fu">setValues</span><span class="op">(</span></span>
<span>  xValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  yValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  yErrorValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.001</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataSet</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataSet: </span></span>
<span><span class="co">#&gt;    Name: My data set </span></span>
<span><span class="co">#&gt;    X dimension: Time </span></span>
<span><span class="co">#&gt;    X unit: h </span></span>
<span><span class="co">#&gt;    Y dimension: Concentration (mass) </span></span>
<span><span class="co">#&gt;    Y unit: mg/l </span></span>
<span><span class="co">#&gt;    Error type: ArithmeticStdDev </span></span>
<span><span class="co">#&gt;    Error unit: mg/l </span></span>
<span><span class="co">#&gt;    Molecular weight: </span></span>
<span><span class="co">#&gt;    LLOQ: </span></span>
<span><span class="co">#&gt;    Meta data: </span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
<p>The user can change the dimensions and units of the values. After changing the dimension, the unit is automatically set to the <em>base unit</em> of the dimension. Changing the dimension or unit <em>does not</em> transform the values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print x, y, and error values</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">xValues</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yValues</span></span>
<span><span class="co">#&gt; [1]  0.0  0.1  0.6 10.0</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yErrorValues</span></span>
<span><span class="co">#&gt; [1] 0.001 0.001 0.100 1.000</span></span>
<span></span>
<span><span class="co"># Change the unit of x-values</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">xUnit</span> <span class="op">&lt;-</span> <span class="va">ospUnits</span><span class="op">$</span><span class="va">Time</span><span class="op">$</span><span class="va">min</span></span>
<span><span class="co"># Print the x values - they did not change</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">xValues</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span>
<span></span>
<span><span class="co"># Change dimension of y-values</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yDimension</span> <span class="op">&lt;-</span> <span class="va">ospDimensions</span><span class="op">$</span><span class="va">Amount</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataSet</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataSet: </span></span>
<span><span class="co">#&gt;    Name: My data set </span></span>
<span><span class="co">#&gt;    X dimension: Time </span></span>
<span><span class="co">#&gt;    X unit: min </span></span>
<span><span class="co">#&gt;    Y dimension: Amount </span></span>
<span><span class="co">#&gt;    Y unit: µmol </span></span>
<span><span class="co">#&gt;    Error type: ArithmeticStdDev </span></span>
<span><span class="co">#&gt;    Error unit: µmol </span></span>
<span><span class="co">#&gt;    Molecular weight: </span></span>
<span><span class="co">#&gt;    LLOQ: </span></span>
<span><span class="co">#&gt;    Meta data: </span></span>
<span><span class="co">#&gt; list()</span></span>
<span></span>
<span><span class="co"># Change the units of y values and error values - they are now different!</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yUnit</span> <span class="op">&lt;-</span> <span class="va">ospUnits</span><span class="op">$</span><span class="va">Amount</span><span class="op">$</span><span class="va">mol</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yErrorUnit</span> <span class="op">&lt;-</span> <span class="va">ospUnits</span><span class="op">$</span><span class="va">Amount</span><span class="op">$</span><span class="va">pmol</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataSet</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataSet: </span></span>
<span><span class="co">#&gt;    Name: My data set </span></span>
<span><span class="co">#&gt;    X dimension: Time </span></span>
<span><span class="co">#&gt;    X unit: min </span></span>
<span><span class="co">#&gt;    Y dimension: Amount </span></span>
<span><span class="co">#&gt;    Y unit: mol </span></span>
<span><span class="co">#&gt;    Error type: ArithmeticStdDev </span></span>
<span><span class="co">#&gt;    Error unit: pmol </span></span>
<span><span class="co">#&gt;    Molecular weight: </span></span>
<span><span class="co">#&gt;    LLOQ: </span></span>
<span><span class="co">#&gt;    Meta data: </span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
<p>Two types of error values are supported - arithmetic error (default) and geometric error, the latter being given in fraction. The user can change the error type:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default error type is "ArithmeticStdDev"</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yErrorType</span></span>
<span><span class="co">#&gt; [1] "ArithmeticStdDev"</span></span>
<span></span>
<span><span class="co"># Change error type to geometric</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yErrorType</span> <span class="op">&lt;-</span> <span class="va">DataErrorType</span><span class="op">$</span><span class="va">GeometricStdDev</span></span>
<span><span class="co"># Error unit is "Unitless" for dimension "Fraction".</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yErrorUnit</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span></span>
<span><span class="co"># Changing error type to arithmetic will set the dimension and unit of the error</span></span>
<span><span class="co"># to the same dimension and unit as the y values</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="va">yErrorType</span> <span class="op">&lt;-</span> <span class="va">DataErrorType</span><span class="op">$</span><span class="va">ArithmeticStdDev</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataSet</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataSet: </span></span>
<span><span class="co">#&gt;    Name: My data set </span></span>
<span><span class="co">#&gt;    X dimension: Time </span></span>
<span><span class="co">#&gt;    X unit: min </span></span>
<span><span class="co">#&gt;    Y dimension: Amount </span></span>
<span><span class="co">#&gt;    Y unit: mol </span></span>
<span><span class="co">#&gt;    Error type: ArithmeticStdDev </span></span>
<span><span class="co">#&gt;    Error unit: mol </span></span>
<span><span class="co">#&gt;    Molecular weight: </span></span>
<span><span class="co">#&gt;    LLOQ: </span></span>
<span><span class="co">#&gt;    Meta data: </span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
<p>A <code>DataSet</code> can store any kind of text meta data as name-values pairs and can be added by the <code>addMetaData()</code> method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add new meta data entries</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="fu">addMetaData</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Molecule"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"Aciclovir"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dataSet</span><span class="op">$</span><span class="fu">addMetaData</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Organ"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"Muscle"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print meta data of the DataSet</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataSet</span><span class="op">$</span><span class="va">metaData</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Molecule</span></span>
<span><span class="co">#&gt; [1] "Aciclovir"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Organ</span></span>
<span><span class="co">#&gt; [1] "Muscle"</span></span></code></pre></div>
<p>A <code>DataSet</code> or multiple <code>DataSet</code>s can be converted to <code>data.frame</code> (or <code>tibble</code>) to be processed in downstream analysis and visualization workflows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a second data set</span></span>
<span><span class="va">dataSet2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/DataSet.html">DataSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Second data set"</span><span class="op">)</span></span>
<span><span class="va">dataSet2</span><span class="op">$</span><span class="fu">setValues</span><span class="op">(</span></span>
<span>  xValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  yValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert data sets to a tibble</span></span>
<span><span class="va">myTibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dataSetToDataFrame.html">dataSetToTibble</a></span><span class="op">(</span>dataSets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dataSet</span>, <span class="va">dataSet2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">myTibble</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 x 14</span></span></span>
<span><span class="co">#&gt;   name      xValues yValues yError~1 xDime~2 xUnit yDime~3 yUnit yErro~4 yErro~5</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> My data ~       1   0      0.001<span style="text-decoration: underline;">00</span> Time    min   Amount  mol   Arithm~ mol    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> My data ~       2   0.1    0.001<span style="text-decoration: underline;">00</span> Time    min   Amount  mol   Arithm~ mol    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> My data ~       3   0.6    0.1     Time    min   Amount  mol   Arithm~ mol    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> My data ~       4  10      1       Time    min   Amount  mol   Arithm~ mol    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Second d~       1   1.00  <span style="color: #BB0000;">NA</span>       Time    h     Concen~ mg/l  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Second d~       2   0     <span style="color: #BB0000;">NA</span>       Time    h     Concen~ mg/l  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Second d~       3   5.00  <span style="color: #BB0000;">NA</span>       Time    h     Concen~ mg/l  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> Second d~       4   8.00  <span style="color: #BB0000;">NA</span>       Time    h     Concen~ mg/l  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> Second d~       5   0.100 <span style="color: #BB0000;">NA</span>       Time    h     Concen~ mg/l  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ... with 4 more variables: molWeight &lt;dbl&gt;, lloq &lt;dbl&gt;, Molecule &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Organ &lt;chr&gt;, and abbreviated variable names 1: yErrorValues, 2: xDimension,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   3: yDimension, 4: yErrorType, 5: yErrorUnit</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="importing-data">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<p>Creating <code>DataSet</code> objects from scratch is a rather advanced use case. Typically, observed data are loaded either from <code>*.pkml</code> files exported from PK-Sim or MoBi, or imported from Excel files. The function <code><a href="../reference/loadDataSetFromPKML.html">loadDataSetFromPKML()</a></code> loads data from the <code>*.pkml</code> file. Complementary to this function is the function <code><a href="../reference/saveDataSetToPKML.html">saveDataSetToPKML()</a></code> that allows to export any <code>DataSet</code> to a <code>*.pkml</code> that can be loaded e.g. in MoBi.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a data set from PKML</span></span>
<span><span class="va">filePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ObsDataAciclovir_1.pkml"</span>, package <span class="op">=</span> <span class="st">"ospsuite"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadDataSetFromPKML.html">loadDataSetFromPKML</a></span><span class="op">(</span>filePath <span class="op">=</span> <span class="va">filePath</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataSet</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataSet: </span></span>
<span><span class="co">#&gt;    Name: Vergin 1995.Iv </span></span>
<span><span class="co">#&gt;    X dimension: Time </span></span>
<span><span class="co">#&gt;    X unit: h </span></span>
<span><span class="co">#&gt;    Y dimension: Concentration (mass) </span></span>
<span><span class="co">#&gt;    Y unit: mg/l </span></span>
<span><span class="co">#&gt;    Error type: ArithmeticStdDev </span></span>
<span><span class="co">#&gt;    Error unit: mg/l </span></span>
<span><span class="co">#&gt;    Molecular weight: 225.21 </span></span>
<span><span class="co">#&gt;    LLOQ: </span></span>
<span><span class="co">#&gt;    Meta data: </span></span>
<span><span class="co">#&gt; $Source</span></span>
<span><span class="co">#&gt; [1] "X:\\Orga\\BTS-TD\\ET\\TP CSB\\Projects\\Internal Projects\\MagenDarm\\TestSubstanzen\\Acyclovir\\Rohdaten_Acyclovir.xls.Vergin 1995 250 mg iv"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $File</span></span>
<span><span class="co">#&gt; [1] "Rohdaten_Acyclovir"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Sheet</span></span>
<span><span class="co">#&gt; [1] "Vergin 1995 250 mg iv"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Molecule</span></span>
<span><span class="co">#&gt; [1] "Aciclovir"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Species</span></span>
<span><span class="co">#&gt; [1] "Human"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Organ</span></span>
<span><span class="co">#&gt; [1] "Peripheral Venous Blood"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Compartment</span></span>
<span><span class="co">#&gt; [1] "Plasma"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Study Id`</span></span>
<span><span class="co">#&gt; [1] "Vergin 1995"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Gender</span></span>
<span><span class="co">#&gt; [1] "Undefined"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Dose</span></span>
<span><span class="co">#&gt; [1] "250 mg"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Route</span></span>
<span><span class="co">#&gt; [1] "IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Patient Id`</span></span>
<span><span class="co">#&gt; [1] "Iv"</span></span></code></pre></div>
<p>Another (and probably the most important) way to create <code>DataSet</code> objects is by importing data from excel files. The function <code><a href="../reference/loadDataSetsFromExcel.html">loadDataSetsFromExcel()</a></code> utilizes the data import functionality implemented in PK-Sim and MoBi and returns a set of <code>DataSet</code> objects. For description of the supported file formats and configurations, please refer to the <a href="https://docs.open-systems-pharmacology.org/shared-tools-and-example-workflows/import-edit-observed-data" class="external-link">OSPS documentation</a>.</p>
<p>Loading observed data from an Excel sheet requires an <code>ImporterConfiguration</code>. The configuration describes mapping of excel sheet columns to numerical data (e.g.  which column contains the x values) or meta data (e.g., description of the applied dose). One way to obtain such configuration is to create it in PK-Sim or MoBi, save it (as an <code>*.xml</code>) file, and load it in R with the <code><a href="../reference/loadDataImporterConfiguration.html">loadDataImporterConfiguration()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a configuration from xml file</span></span>
<span><span class="va">filePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"dataImporterConfiguration.xml"</span>, package <span class="op">=</span> <span class="st">"ospsuite"</span><span class="op">)</span></span>
<span><span class="va">importerConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadDataImporterConfiguration.html">loadDataImporterConfiguration</a></span><span class="op">(</span>configurationFilePath <span class="op">=</span> <span class="va">filePath</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">importerConfiguration</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataImporterConfiguration: </span></span>
<span><span class="co">#&gt;    Time column: Time [h] </span></span>
<span><span class="co">#&gt;    Time unit: h </span></span>
<span><span class="co">#&gt;    Time unit from column: FALSE </span></span>
<span><span class="co">#&gt;    Measurement column: Concentration (mass)[ng/ml] </span></span>
<span><span class="co">#&gt;    Measurement unit: ng/ml </span></span>
<span><span class="co">#&gt;    Measurement unit from column: FALSE </span></span>
<span><span class="co">#&gt;    Error column: Error [ng/ml] </span></span>
<span><span class="co">#&gt;    Error type: ArithmeticStdDev </span></span>
<span><span class="co">#&gt;    Error unit: ng/ml </span></span>
<span><span class="co">#&gt;    Grouping columns: Study Id Organ Compartment Species Gender Molecule Route MW Patient Id Dose [unit] </span></span>
<span><span class="co">#&gt;    Sheets: </span></span>
<span><span class="co">#&gt;    Naming pattern: {Source}.{Sheet}.{Study Id}.{Organ}.{Compartment}.{Species}.{Gender}.{Molecule}.{Route}.{Molecular Weight}.{Subject Id}.{Dose}</span></span></code></pre></div>
<p>A data importer configuration can also be created from scratch and has to be manually populated by the user. Alternatively, the user can let the software “guess” the configuration for a given excel sheet:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Excel file</span></span>
<span><span class="va">excelFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CompiledDataSet.xlsx"</span>, package <span class="op">=</span> <span class="st">"ospsuite"</span><span class="op">)</span></span>
<span><span class="va">sheetName</span> <span class="op">&lt;-</span> <span class="st">"TestSheet_1"</span></span>
<span></span>
<span><span class="co"># Create importer configuration for the excel sheet</span></span>
<span><span class="va">importerConfiguration_guessed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createImporterConfigurationForFile.html">createImporterConfigurationForFile</a></span><span class="op">(</span></span>
<span>  filePath <span class="op">=</span> <span class="va">excelFilePath</span>,</span>
<span>  sheet <span class="op">=</span> <span class="va">sheetName</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">importerConfiguration</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataImporterConfiguration: </span></span>
<span><span class="co">#&gt;    Time column: Time [h] </span></span>
<span><span class="co">#&gt;    Time unit: h </span></span>
<span><span class="co">#&gt;    Time unit from column: FALSE </span></span>
<span><span class="co">#&gt;    Measurement column: Concentration (mass)[ng/ml] </span></span>
<span><span class="co">#&gt;    Measurement unit: ng/ml </span></span>
<span><span class="co">#&gt;    Measurement unit from column: FALSE </span></span>
<span><span class="co">#&gt;    Error column: Error [ng/ml] </span></span>
<span><span class="co">#&gt;    Error type: ArithmeticStdDev </span></span>
<span><span class="co">#&gt;    Error unit: ng/ml </span></span>
<span><span class="co">#&gt;    Grouping columns: Study Id Organ Compartment Species Gender Molecule Route MW Patient Id Dose [unit] </span></span>
<span><span class="co">#&gt;    Sheets: </span></span>
<span><span class="co">#&gt;    Naming pattern: {Source}.{Sheet}.{Study Id}.{Organ}.{Compartment}.{Species}.{Gender}.{Molecule}.{Route}.{Molecular Weight}.{Subject Id}.{Dose}</span></span></code></pre></div>
<p>It is important to manually check the created configuration, as the automated configuration recognition cannot cover all possible cases.</p>
<p>If only specific sheets from the excel file should be imported, they can be specified in the <code>ImporterConfiguration</code>. The following example loads the sheets <code>TestSheet_1</code> and <code>TestSheet_1_withMW</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Excel file</span></span>
<span><span class="va">excelFilePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CompiledDataSet.xlsx"</span>, package <span class="op">=</span> <span class="st">"ospsuite"</span><span class="op">)</span></span>
<span><span class="va">sheetName</span> <span class="op">&lt;-</span> <span class="st">"TestSheet_1"</span></span>
<span></span>
<span><span class="co"># Create importer configuration for the excel sheet</span></span>
<span><span class="va">importerConfiguration_guessed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createImporterConfigurationForFile.html">createImporterConfigurationForFile</a></span><span class="op">(</span></span>
<span>  filePath <span class="op">=</span> <span class="va">excelFilePath</span>,</span>
<span>  sheet <span class="op">=</span> <span class="va">sheetName</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Add sheet names to the configuration</span></span>
<span><span class="va">importerConfiguration_guessed</span><span class="op">$</span><span class="va">sheets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TestSheet_1"</span>, <span class="st">"TestSheet_1_withMW"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="va">dataSets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadDataSetsFromExcel.html">loadDataSetsFromExcel</a></span><span class="op">(</span></span>
<span>  xlsFilePath <span class="op">=</span> <span class="va">excelFilePath</span>,</span>
<span>  importerConfigurationOrPath <span class="op">=</span> <span class="va">importerConfiguration_guessed</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Currently, <code>DataImporterConfiguration</code> created from scratch or for a specific data sheet does not support all features of importer configuration, such as specifying the column containing the molecular weight of the measured molecule or the LLOQ values. It is therefore recommended that you use importer configurations created in PK-Si or MoBi.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Sevestre, Pavel Balazki, Juri Solodenko, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
