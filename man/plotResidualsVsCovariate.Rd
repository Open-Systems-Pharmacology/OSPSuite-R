% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot-with-ospsuite-plots.R
\name{plotResidualsVsCovariate}
\alias{plotResidualsVsCovariate}
\title{Plot Residuals vs Covariate}
\usage{
plotResidualsVsCovariate(
  plotData,
  metaData = NULL,
  mapping = ggplot2::aes(),
  xUnit = NULL,
  yUnit = NULL,
  residualScale = "log",
  xAxis = "observed",
  ...
)
}
\arguments{
\item{plotData}{An object of class \code{DataCombined} or a \code{data.table}. If a
\code{data.table}, it must include the following:
\itemize{
\item \code{xValues}: Numeric time points.
\item \code{yValues}: Observed or simulated values (numeric).
\item \code{group}: Grouping variable (factor or character).
\item \code{name}: Name for the dataset (factor or character).
\item \code{xUnit}: Unit of the x-axis values (character).
\item \code{yUnit}: Unit of the y-axis values (character).
\item \code{dataType}: Specifies data type—either \code{observed} or \code{simulated}.
\item Optional:
\itemize{
\item \code{yErrorType}: Type of y error, relative to \code{ospsuite::DataErrorType}.
\item \code{yErrorValues}: Numeric error values.
\item \code{yMin}, \code{yMax}: Custom ranges for y-axis instead of error types.
\item \code{IndividualId}: Used for aggregation of simulated population data.
}
}}

\item{metaData}{A list containing metadata for the plot. If NULL, a default
list is constructed from the data. Expected structure includes information
about dimensions and units for both x and y axes.}

\item{mapping}{A ggplot2 aesthetic mapping object. Default is
\code{ggplot2::aes()}. This is added or replaces the default mapping constructed
by the data.}

\item{xUnit}{A character string specifying the target unit for the time
values. (only relevant if \code{xAxis = "time"}) If \code{NULL} (default), the most
frequent unit in the data is used. For available units, see
\code{ospsuite::ospUnits}.}

\item{yUnit}{A character string specifying the target unit for the simulated
and observed y-values used for residual calculation and (if \code{xAxis != "time"}) displayed on the x-Axis. If \code{NULL} (default), the most frequent
unit in the data is used. For available units, see \code{ospsuite::ospUnits}.}

\item{residualScale}{Either "linear", "log", or "ratio" method for computing
residuals. Default is \code{log}.}

\item{xAxis}{A character string specifying what to display on the x-axis.
Options are \code{"time"} (time points from xValues), \code{"observed"} (observed
values, default), or \code{"predicted"} (predicted/simulated values).}

\item{...}{
  Arguments passed on to \code{\link[ospsuite.plots:plotYVsX]{ospsuite.plots::plotYVsX}}, \code{\link[ospsuite.plots:plotResVsCov]{ospsuite.plots::plotResVsCov}}
  \describe{
    \item{\code{geomPointAttributes}}{A \code{list} with arguments which are passed on to the call \code{ggplot2::geom_point}}
    \item{\code{geomComparisonLineAttributes}}{A \code{list} of arguments passed to \code{ggplot2::hline} or \code{ggplot2::abline} to display comparison lines.}
    \item{\code{geomLLOQAttributes}}{A \code{list} with arguments which are passed on to the call \code{ggplot2::geom_hline}}
    \item{\code{groupAesthetics}}{A character vector of aesthetic names used for grouping data points when calculating
comparison statistics. Data will be grouped by combinations of these aesthetics before computing counts
and proportions within comparison lines. Common grouping aesthetics include \code{"colour"}, \code{"fill"}, \code{"shape"}.}
    \item{\code{addRegression}}{A boolean that activates the insertion of a regression line.}
    \item{\code{xScale}}{either 'linear' then \code{ggplot2::scale_x_continuous()} or 'log' then \code{ggplot2::scale_x_log10()} is used}
    \item{\code{xScaleArgs}}{list of arguments passed to \code{ggplot2::scale_x_continuous()} or \code{ggplot2::scale_x_log10()}}
    \item{\code{yScale}}{either 'linear' then \code{ggplot2::scale_y_continuous()} or 'log' then \code{ggplot2::scale_y_log10()} is used}
    \item{\code{comparisonLineVector}}{A vector defining the comparison lines.}
  }}
}
\value{
A \code{ggplot2} plot object representing residuals vs time, observed, or
predicted values.
}
\description{
Plots residuals vs a covariate (time, observed, or predicted
values), grouped by "group".

This function visualizes the residuals against time, observed, or predicted
(simulated) values, helping to assess model performance.
}
\details{
\subsection{Residual Calculation}{

Residuals are calculated by pairing observed and simulated data at matching
time points within the same group. Only datasets that can be paired (i.e.,
have corresponding observed and simulated values) are included in the
residual plot. The function automatically removes unpaired datasets with a
warning, converts units to ensure consistent comparisons, and computes
residuals as the difference between observed and predicted values.
}

\subsection{Residual Scales}{

The \code{residualScale} parameter controls how residuals are displayed:
\itemize{
\item \code{linear}: Absolute residuals (Observed - Predicted). Values centered around
zero indicate good model fit. Useful for normally distributed errors.
\item \code{log}: Log-transformed residuals, calculated as log(Observed / Predicted).
Values centered around zero indicate good fit. Preferred for log-normally
distributed data or when errors are proportional to magnitude.
\item \code{ratio}: Ratio of observed to predicted (Observed / Predicted). Values
centered around 1.0 indicate good fit. Useful for understanding relative
prediction error.
}
}
}
\examples{
\dontrun{
# Generate a residuals vs observed plot for the provided data
plotResidualsVsCovariate(
  myDataCombined,
  xUnit = ospUnits$Time$h,
  yUnit = ospUnits$`Concentration [mass]`$`µg/l`,
  xAxis = "time",
  residualScale = 'linear'
)

# Generate a residuals vs predicted plot
plotResidualsVsCovariate(myDataCombined, xAxis = "predicted")

# Generate a residuals vs time plot
plotResidualsVsCovariate(myDataCombined, xAxis = "time")
}
}
\seealso{
Other plot functions based on ospsuite.plots: 
\code{\link{plotPredictedVsObserved}()},
\code{\link{plotQuantileQuantilePlot}()},
\code{\link{plotResidualsAsHistogram}()},
\code{\link{plotTimeProfile}()}
}
\concept{plot functions based on ospsuite.plots}
